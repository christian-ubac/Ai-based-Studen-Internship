import{r,u as P,o as d,c as p,b as t,n as R,w as v,d as h,t as y}from"./index-49dffa98.js";/* empty css                                                       */const S={class:"upload-page"},U={class:"upload-card"},V={key:0,class:"upload-text"},E={key:1,class:"file-info"},L={key:0,class:"error-message"},B={class:"actions"},H=["disabled"],q={__name:"UploadResume",setup(M){const c=r(!1),l=r(null),i=r(""),u=r(!1),_=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],C=[".pdf",".doc",".docx"],f=r(null),m=P();function g(a){if(i.value="",!a)return!1;const e=_.includes(a.type),o=a.name||"",n=o.lastIndexOf("."),s=n!==-1?o.slice(n).toLowerCase():"",O=C.includes(s);return e||O?(l.value=a,!0):(i.value="Invalid file type. Please upload a PDF, DOC, or DOCX file.",!1)}function D(a){const e=a.target.files&&a.target.files[0];g(e)}function x(){c.value=!0}function b(){c.value=!1}function k(a){var o,n;c.value=!1;const e=(n=(o=a.dataTransfer)==null?void 0:o.files)==null?void 0:n[0];g(e)}function w(){l.value=null,i.value="",f.value&&(f.value.value=null)}async function F(){if(!l.value){i.value="Please select a file first.";return}u.value=!0,i.value="";const a=new FormData;a.append("file",l.value);try{const e=await fetch("/api/upload-resume",{method:"POST",body:a});if(!e.ok){const s=await e.text().catch(()=>"");throw new Error(`Upload failed: ${s||e.status}`)}const o=await e.json(),n=o==null?void 0:o.resume_id;if(o!=null&&o.recommendations&&n)try{const s=`recommendations_for_resume_${n}`;localStorage.setItem(s,JSON.stringify(o.recommendations))}catch(s){console.warn("Failed to cache recommendations locally",s)}if(n){try{await fetch("/scrape/internships?query=internship&limit=20")}catch(s){console.warn("Scraper trigger failed",s)}await m.push({name:"Recommendations",query:{resumeId:n}})}else{try{await fetch("/scrape/internships?query=internship&limit=20")}catch{}await m.push({name:"Recommendations"})}}catch(e){console.error(e),i.value="An error occurred during upload. Please try again.",u.value=!1}}function I(){w();try{m.back()}catch{}}return(a,e)=>(d(),p("div",S,[t("div",U,[e[3]||(e[3]=t("h3",null,"Upload Your Resume",-1)),e[4]||(e[4]=t("p",null,"We'll match you with the best AI internships. (PDF, DOC, or DOCX only)",-1)),t("div",{class:R(["drop-zone",{"drag-over":c.value}]),onDragover:v(x,["prevent"]),onDragleave:v(b,["prevent"]),onDrop:v(k,["prevent"])},[e[1]||(e[1]=t("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M14 11V17H10V11H7L12 6L17 11H14ZM19.35 10.0391C18.67 6.59906 15.64 4 12 4C9.11 4 6.6 5.64 5.35 8.03906C2.34 8.35906 0 10.9091 0 13.9991C0 17.3091 2.69 19.9991 6 19.9991H19C21.76 19.9991 24 17.7591 24 14.9991C24 12.4591 22.09 10.4091 19.35 10.0391Z",fill:"#6366f1",opacity:"0.8"})],-1)),l.value?h("",!0):(d(),p("p",V,[...e[0]||(e[0]=[t("span",{class:"primary-text"},"Drag and drop your resume here",-1),t("span",{class:"secondary-text"},"Supported formats: PDF, DOC, or DOCX",-1)])])),e[2]||(e[2]=t("label",{for:"file-input",class:"browse-button"},"Choose File",-1)),t("input",{type:"file",id:"file-input",ref_key:"fileInput",ref:f,onChange:D,accept:".pdf,.doc,.docx",hidden:""},null,544),l.value?(d(),p("div",E,[t("span",null,y(l.value.name),1),t("button",{onClick:w,class:"remove-btn",title:"Remove file"},"Ã—")])):h("",!0)],34),i.value?(d(),p("div",L,y(i.value),1)):h("",!0),t("div",B,[t("button",{class:"btn-cancel",onClick:I},"Cancel"),t("button",{class:"btn-upload",onClick:F,disabled:!l.value||u.value},y(u.value?"Uploading...":"Upload & Find Internships"),9,H)])])]))}};export{q as default};
